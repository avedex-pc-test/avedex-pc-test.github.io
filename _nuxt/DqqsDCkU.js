import{_ as a}from"./BQhZAvhG.js";import{E as e}from"./DRHcIXYw.js";import{f as t,v as s,y as i,af as r,r as n,g as o,J as l,x as c,m as u,n as p,am as v,al as m,q as d,P as _,Q as h,a3 as g,an as y,ao as f,b,c as k,o as T,U as j,L as C,D as w,aj as x,i as I,a1 as S,C as z,w as N,ap as V,s as O,F as $,as as U,at as A,au as D,a2 as F,_ as E}from"./BY9EIVYr.js";import"./BObx0-it.js";import"./DuT2dQq8.js";import{H as q,e as P,h as B,i as H,j as M,k as R,l as X,m as L,n as G,o as J,p as Q,t as W,v as Y,w as Z,x as K,y as aa,z as ea,A as ta,B as sa,D as ia,C as ra,E as na,F as oa,P as la,G as ca}from"./Ch8Au6_H.js";import{g as ua}from"./CGucPBMD.js";import"./DNHovcs4.js";import{r as pa,a as va}from"./DxpqxFqd.js";import"./khxch50D.js";import"./C04P7iJb.js";import"./D600_RKl.js";import"./B7cUFrfB.js";import"./DBQWc8Xl.js";import"./DJKaFdKc.js";import"./INkfrj6o.js";import"./BdSP2G6B.js";import"./CJXpfIx0.js";import"./BZI4qv_R.js";import"./TAIZXAse.js";import"./eYKr95x1.js";import"./bcVq5sfG.js";import"./gfa7pY1Q.js";import"./_R2nDvl_.js";const ma={style:{height:"calc(100vh - 185px)"}},da=E(t({__name:"activity",props:{listMapFunction:{type:Function},activeChain:{},activeSubTab:{},activeTab:{}},setup(t){const{t:E}=s(),da=i(),_a=t,{rankConditions:ha}=r(da);function ga(a){ha.value[_a.activeTab].sort=a,ka.value.pageNO=1,Sa()}function ya(...a){a.forEach((a=>{U(ha.value[_a.activeTab].filter,a[0],a[1])})),ka.value.pageNO=1,Sa()}const fa=n([]),ba=o((()=>da.pumpSetting.isBlacklist?fa.value.filter((a=>{return e=a,!(-1!==da.pumpBlackList.findIndex((a=>a.address==e.token&&"ca"==a.type||a.address==e.symbol&&"keyword"==a.type)));var e})):fa.value));const ka=n({pageNO:1,pageSize:50,total:0}),Ta=l(!0),ja=l(!1),Ca=o((()=>_a.activeTab+"TableColumns"));let wa,xa=c(Ca.value,q(E));function Ia({rowData:a}){A(`/token/${a.target_token}-${a.chain}`)}async function Sa(a=!0){var e,t;try{a&&(ja.value=!0);const{total:s,...i}=ka.value,r=_().evmAddress||h().address||"",n=["created_at_max","created_at_min"].reduce(((a,e)=>(a[e]&&(a[e]=g().unix()-60*Number(a[e])),a)),{...null==(e=ha.value[_a.activeTab])?void 0:e.filter}),o=await ua({category:_a.activeTab,...i,chain:"AllChains"!==_a.activeChain?_a.activeChain:"",...null==(t=ha.value[_a.activeTab])?void 0:t.sort,...n,self_address:r});ka.value.total=o.total,fa.value=(o.data||[]).map(_a.listMapFunction),a&&function(){za.send({jsonrpc:"2.0",method:"unsubscribe",params:["price_extra"],id:1});const a=fa.value.map((a=>`${a.pair}-${a.chain}`));za.send({jsonrpc:"2.0",method:"subscribe",params:["price_extra",a],id:1})}(),clearTimeout(wa),wa=window.setTimeout((()=>{Sa(!1)}),1e4)}finally{ja.value=!1}}u((()=>_a.activeTab),(()=>{qa(),xa=c(Ca.value,q(E)),ka.value.pageNO=1,Sa()}),{immediate:!0}),p((()=>{Sa()})),v((()=>{clearTimeout(wa)})),m((()=>{qa(),clearTimeout(wa),wa=window.setTimeout((()=>{Sa(!1)}),1e4)})),d((()=>{clearTimeout(wa)})),u((()=>[_a.activeChain,_a.activeTab]),(()=>{ka.value.pageNO=1,Sa()}));const za=y();u((()=>za.wsResult[f.PRICE_EXTRA]),(({prices:a})=>{var e;const t=Array.isArray(a)?a.reduce(((a,e)=>(a[e.pair+"-"+e.chain]=e,a)),{}):{},s=fa.value.map((a=>{const e=t[a.pair+"-"+a.chain];if(e){delete e.holders,delete e.last_trade_at;const t=a.current_price_usd?(a.market_cap||0)/a.current_price_usd*(e.uprice||0):0;return{...a,market_cap:t,current_price_usd:e.uprice,...e}}return a})),{sort:i,sort_dir:r}=null==(e=ha.value[_a.activeTab])?void 0:e.sort,n={asc:"1",desc:"-1"}[r];n&&(fa.value=s.toSorted(((a,e)=>(a[i]-e[i])*n)))}));const Na=h(),Va=_(),Oa=o((()=>Va.evmAddress||Na.address));async function $a(a,e){Oa.value?(Na.address&&await Na.signMessageForFavorite(),e.is_fav?function(a){ja.value=!0,pa(`${a.token}-${a.chain}`,Oa.value).then((()=>{F.success(E("cancelled1")),a.is_fav=!1})).catch((a=>{})).finally((()=>{ja.value=!1}))}(e):function(a){ja.value=!0,va(`${a.token}-${a.chain}`,Oa.value,0).then((()=>{F.success(E("collected")),a.is_fav=!0})).catch((a=>{})).finally((()=>{ja.value=!1}))}(e)):D()}function Ua(){ka.value.pageNO=1,Sa()}const Aa={price_change_dynamic:a=>a.isVisible&&!["1m","24h"].includes(da.rankCommon.activeInterval),quick:a=>a.isVisible&&da.rankCommon.quickVisible},Da=o((()=>xa.value.filter((a=>Aa[a.key]?Aa[a.key](a):a.isVisible)))),Fa=o((()=>({poolPair:Q,headline:()=>E("aiSummary"),mCap:J,price_change_1m:G,price_change_24h:G,price_change_dynamic:G,tvl:L,dynamicVolAndTxs:X,markers_dynamic:R,holders:M,smart_money_buy_volume_24h:H,dex:()=>"DEX",security:()=>E("security"),holders_top10_ratio:B,quick:()=>E("quick"),sniper_tx_count:P}))),Ea=o((()=>({poolPair:la,headline:oa,mCap:na,price_change_1m:({row:a})=>b(ca,{row:a,activeInterval:"1m"},null),price_change_24h:({row:a})=>b(ca,{row:a,activeInterval:"24h"},null),price_change_dynamic:({row:a})=>b(ca,{row:a,activeInterval:da.rankCommon.activeInterval},null),tvl:ra,dynamicVolAndTxs:ia,markers_dynamic:sa,holders:ta,smart_money_buy_volume_24h:ea,dex:aa,security:K,holders_top10_ratio:Z,quick:Y,sniper_tx_count:W})));function qa(){ha.value[_a.activeTab]||(ha.value[_a.activeTab]={sort:{sort:"",sort_dir:""},filter:{}})}return(t,s)=>{const i=a,r=e,n=x;return T(),k($,null,[j((T(),k("div",ma,[b(i,{loading:I(ja),data:I(ba),columns:I(Da),"header-height":40,"row-height":81,fixed:"",style:{"--el-bg-color":"var(--secondary-bg)"},"row-class":"cursor-pointer [&&]:[--el-table-border:1px_solid_var(--main-divider)]",rowEventHandlers:{onClick:Ia}},S({_:2},[z(I(Da),(a=>({name:`header-${a.key}`,fn:N((()=>{var e;return[(T(),C(V(I(Fa)[a.key]),{key:t.activeTab,isVolUSDT:I(Ta),"onUpdate:isVolUSDT":s[0]||(s[0]=a=>O(Ta)?Ta.value=a:null),sortConditions:null==(e=I(ha)[t.activeTab])?void 0:e.sort,setSortConditions:ga,setFilterForm:ya,activeInterval:a.activeInterval||I(da).rankCommon.activeInterval},null,40,["isVolUSDT","sortConditions","activeInterval"]))]}))}))),z(I(Da),(a=>({name:`cell-${a.key}`,fn:N((({row:e,rowIndex:s})=>[(T(),C(V(I(Ea)[a.key]),{class:"text-14px",isVolUSDT:I(Ta),row:e,rowIndex:s,pageNO:I(ka).pageNO,pageSize:I(ka).pageSize,activeInterval:a.activeInterval||I(da).rankCommon.activeInterval,activeChain:t.activeChain,onCollect:$a},null,40,["isVolUSDT","row","rowIndex","pageNO","pageSize","activeInterval","activeChain"]))]))})))]),1032,["loading","data","columns","rowEventHandlers"])])),[[n,I(ja)]]),I(ka).total?(T(),C(r,{key:0,"current-page":I(ka).pageNO,"onUpdate:currentPage":s[1]||(s[1]=a=>I(ka).pageNO=a),"page-size":I(ka).pageSize,"onUpdate:pageSize":s[2]||(s[2]=a=>I(ka).pageSize=a),class:"mt-5px py-9px flex justify-center [&&]:[--el-pagination-button-height:18px]",layout:"total, prev, pager, next",total:I(ka).total||0,small:!1,"page-sizes":[20,50,100,200,300,400],onSizeChange:Ua,onCurrentChange:s[3]||(s[3]=()=>Sa())},null,8,["current-page","page-size","total"])):w("",!0)],64)}}}),[["__scopeId","data-v-29391c42"]]);export{da as default};
